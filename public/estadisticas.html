<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Estad√≠sticas - Juegos Ol√≠mpicos Mart√≠nez</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root {
      /* Colores para logros */
      --logro-oro-fondo: #fff9c4;
      --logro-oro-borde: #ffd700;
      --logro-plata-fondo: #f5f5f5;
      --logro-plata-borde: #c0c0c0;
      --logro-bronce-fondo: #ffecb3;
      --logro-bronce-borde: #cd7f32;
      --logro-verde-fondo: #e8f5e9;
      --logro-verde-borde: #4caf50;
      --logro-azul-fondo: #e3f2fd;
      --logro-azul-borde: #2196f3;
      --logro-morado-fondo: #f3e5f5;
      --logro-morado-borde: #9c27b0;
    }

    .stats-container {
      max-width: 1000px;
      margin: 0 auto;
      padding: 20px;
    }
    .stat-card {
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    
    /* Estilos para los logros */
    .logro {
      display: flex;
      align-items: center;
      background: rgb(255, 255, 207);
      border-radius: 10px;
      padding: 1rem;
      margin-bottom: 1rem;
      border-left: 4px solid #ffc107;
    }
    
    .logro-icono {
      font-size: 2rem;
      margin-right: 1rem;
      min-width: 50px;
      text-align: center;
    }
    
    .logro-contenido {
      flex: 1;
    }
    
    .logro h3 {
      margin: 0 0 0.5rem 0;
      color: #343a40;
    }
    
    .logro p {
      margin: 0 0 0.5rem 0;
      color: #6c757d;
    }
    
    .medal-count {
      display: flex;
      gap: 1rem;
      margin-top: 0.5rem;
    }
    
    .medal-count span {
      display: flex;
      align-items: center;
      gap: 0.25rem;
      font-weight: 600;
    }
    
    .gold { color: #ffc107; }
    .silver { color: #c0c0c0; }
    .bronze { color: #cd7f32; }
    
    .no-logros {
      text-align: center;
      padding: 2rem 1rem;
      color: #6c757d;
    }
    .stat-card h2 {
      color: var(--blue);
      margin: 0;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .achievements-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
      padding-bottom: 0.75rem;
      border-bottom: 2px solid #eee;
    }
    
    .btn-secondary {
      background: #f8f9fa;
      color: #495057;
      border: 1px solid #dee2e6;
      border-radius: 50px;
      padding: 0.5rem 1rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.9rem;
      transition: all 0.2s ease;
    }
    
    .btn-secondary:hover {
      background: #e9ecef;
      transform: translateY(-1px);
    }
    
    .btn-secondary i {
      font-size: 0.9em;
    }
    .chart-container {
      position: relative;
      height: 300px;
      margin: 20px 0;
    }
    .medal-stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
      margin: 1.5rem 0;
    }
    .medal-stat {
      text-align: center;
      padding: 1rem;
      border-radius: 8px;
      color: white;
      font-weight: bold;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .medal-stat.gold { background: linear-gradient(135deg, #FFD700, #FFA500); }
    .medal-stat.silver { background: linear-gradient(135deg, #C0C0C0, #A9A9A9); }
    .medal-stat.bronze { background: linear-gradient(135deg, #CD7F32, #8B4513); }
    .medal-stat .count {
      font-size: 2rem;
      margin: 0.5rem 0;
    }
    .top-moments {
      list-style: none;
      padding: 0;
    }
    .moment {
      background: #f8f9fa;
      padding: 1rem;
      margin-bottom: 0.5rem;
      border-radius: 5px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .moment .medal {
      padding: 0.2rem 0.5rem;
      border-radius: 3px;
      color: white;
      font-size: 0.8rem;
      margin-left: 0.5rem;
    }
    .moment .medal.gold { background: #FFD700; }
    .moment .medal.silver { background: #C0C0C0; }
    .moment .medal.bronze { background: #CD7F32; }
    .btn-back {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      margin: 0 0 2rem 0;
      padding: 0.8rem 1.8rem;
      background: linear-gradient(135deg, var(--blue) 0%, #1e88e5 100%);
      color: white;
      text-decoration: none;
      border-radius: 50px;
      font-weight: 600;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(41, 182, 246, 0.3);
      border: none;
      font-size: 1.05rem;
    }
    
    .btn-back:hover {
      background: linear-gradient(135deg, #1e88e5 0%, #1565c0 100%);
      transform: translateY(-2px) scale(1.02);
      box-shadow: 0 6px 20px rgba(41, 182, 246, 0.4);
    }
  </style>
</head>
<body>
  <header>
    <h1 class="main-title">Estad√≠sticas</h1>
  </header>
  
  <main class="stats-container">
    <a href="index.html" class="btn-back">‚Üê Volver al Ranking</a>
    
    <div class="stat-card">
      <h2>üìä Distribuci√≥n de Medallas</h2>
      <div class="chart-container">
        <canvas id="medalsChart"></canvas>
      </div>
    </div>
    
    <div class="stat-card">
      <h2>üèÖ Total de Medallas</h2>
      <div class="medal-stats">
        <div class="medal-stat gold">
          <span>Oro</span>
          <div class="count" id="totalGold">0</div>
          <span>medallas</span>
        </div>
        <div class="medal-stat silver">
          <span>Plata</span>
          <div class="count" id="totalSilver">0</div>
          <span>medallas</span>
        </div>
        <div class="medal-stat bronze">
          <span>Bronce</span>
          <div class="count" id="totalBronze">0</div>
          <span>medallas</span>
        </div>
      </div>
    </div>
    
    <section class="stat-card">
        <div class="achievements-header">
          <h2>üèÜ Logros Destacados</h2>
          <button id="btnReiniciarContadores" class="btn-secondary" title="Reiniciar contadores de logros">
            <i class="fas fa-sync-alt"></i> Reiniciar Contadores
          </button>
        </div>
        <div id="achievementsContainer">
          <!-- Los logros se insertar√°n aqu√≠ din√°micamente -->
        </div>
      </section>
    
    <a href="index.html" class="btn-back">‚Üê Volver al Ranking</a>
  </main>

  <footer>
    <p>Juegos Ol√≠mpicos Mart√≠nez 2025 - Todos los derechos reservados</p>
  </footer>

  <script>
    // Funci√≥n para reiniciar los contadores de logros
    function reiniciarContadores() {
      if (confirm('¬øEst√°s seguro de que deseas reiniciar todos los contadores de logros?\n\nEsta acci√≥n eliminar√° el historial de posiciones subidas, el historial de cambios de primer puesto y otros contadores internos.')) {
        // Eliminar el historial de mejoras
        localStorage.removeItem('mejorasTotales');
        // Eliminar el historial de clasificaciones
        localStorage.removeItem('historialClasificacion');
        // Eliminar el historial de cambios de primer puesto
        localStorage.removeItem('historialPrimerPuesto');
        // Recargar la p√°gina para actualizar la visualizaci√≥n
        window.location.reload();
      }
    }

    // Configurar el bot√≥n de reiniciar contadores
    document.addEventListener('DOMContentLoaded', function() {
      const btnReiniciar = document.getElementById('btnReiniciarContadores');
      if (btnReiniciar) {
        btnReiniciar.addEventListener('click', reiniciarContadores);
        
        // Mostrar el bot√≥n solo si hay algo que reiniciar
        const hayContadores = localStorage.getItem('mejorasTotales') || localStorage.getItem('historialClasificacion');
        btnReiniciar.style.display = hayContadores ? 'flex' : 'none';
      }
      // Cargar datos desde localStorage
      const participants = JSON.parse(localStorage.getItem('olimpMartinez2025')) || [];
      
      // Calcular totales
      const totals = participants.reduce((acc, p) => {
        acc.gold += p.gold || 0;
        acc.silver += p.silver || 0;
        acc.bronze += p.bronze || 0;
        return acc;
      }, { gold: 0, silver: 0, bronze: 0 });
      
      // Actualizar contadores
      document.getElementById('totalGold').textContent = totals.gold;
      document.getElementById('totalSilver').textContent = totals.silver;
      document.getElementById('totalBronze').textContent = totals.bronze;
      
      // Gr√°fico de distribuci√≥n
      const ctx = document.getElementById('medalsChart').getContext('2d');
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: ['Oro', 'Plata', 'Bronce'],
          datasets: [{
            label: 'Total de Medallas',
            data: [totals.gold, totals.silver, totals.bronze],
            backgroundColor: [
              'rgba(255, 215, 0, 0.7)',
              'rgba(192, 192, 192, 0.7)',
              'rgba(205, 127, 50, 0.7)'
            ],
            borderColor: [
              'rgba(255, 215, 0, 1)',
              'rgba(192, 192, 192, 1)',
              'rgba(205, 127, 50, 1)'
            ],
            borderWidth: 1
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            y: {
              beginAtZero: true,
              ticks: {
                stepSize: 1
              }
            }
          },
          plugins: {
            legend: {
              display: false
            }
          }
        }
      });
      
      // Funci√≥n para cargar logros destacados
      function cargarLogrosDestacados() {
        const container = document.getElementById('achievementsContainer');
        container.innerHTML = '';
        
        // Obtener datos
        const participantes = JSON.parse(localStorage.getItem('olimpMartinez2025') || '[]');
        const medallas = JSON.parse(localStorage.getItem('medalDates') || '[]');
        
        // 1. Encontrar al participante con m√°s medallas totales
        const participantesConTotales = participantes.map(p => ({
          nombre: p.name,
          oro: p.gold || 0,
          plata: p.silver || 0,
          bronce: p.bronze || 0,
          total: (p.gold || 0) + (p.silver || 0) + (p.bronze || 0)
        })).sort((a, b) => b.total - a.total);
        
        // Funci√≥n para formatear lista de nombres
        function formatearNombres(nombres) {
          if (!nombres || nombres.length === 0) return '';
          if (nombres.length === 1) return nombres[0];
          if (nombres.length === 2) return `${nombres[0]} y ${nombres[1]}`;
          return nombres.slice(0, -1).join(', ') + ' y ' + nombres[nombres.length - 1];
        }

        // 2. Encontrar participantes que solo tengan medallas de oro
        const soloOro = participantesConTotales.filter(p => 
          p.oro > 0 && p.plata === 0 && p.bronce === 0
        );
        
        // 3. Encontrar participantes con equilibrio perfecto (mismo n√∫mero de oros, platas y bronces)
        const equilibrioPerfecto = participantesConTotales.filter(p => 
          p.oro > 0 && p.oro === p.plata && p.oro === p.bronce
        );
        
        // 4. Agrupar participantes por logros de "Estilo √önico"
        const estiloUnico = {
          oro: participantesConTotales.filter(p => p.oro > 0 && p.plata === 0 && p.bronce === 0),
          plata: participantesConTotales.filter(p => p.plata > 0 && p.oro === 0 && p.bronce === 0),
          bronce: participantesConTotales.filter(p => p.bronce > 0 && p.oro === 0 && p.plata === 0)
        };
        
        // 5. Logro "Comeback del a√±o" - Recuperar el primer puesto despu√©s de perderlo
        const historialPrimerPuesto = JSON.parse(localStorage.getItem('historialPrimerPuesto') || '{}');
        let maxVecesRecuperado = 0;
        const mejoresComebacks = [];
        
        // Primero encontrar el n√∫mero m√°ximo de recuperaciones
        Object.entries(historialPrimerPuesto).forEach(([nombre, datos]) => {
            if (datos.vecesRecuperado > 0) {
                if (datos.vecesRecuperado > maxVecesRecuperado) {
                    maxVecesRecuperado = datos.vecesRecuperado;
                }
            }
        });
        
        // Luego encontrar a todos los que tengan ese m√°ximo
        Object.entries(historialPrimerPuesto).forEach(([nombre, datos]) => {
            if (datos.vecesRecuperado === maxVecesRecuperado && maxVecesRecuperado > 0) {
                mejoresComebacks.push({
                    nombre: nombre,
                    veces: datos.vecesRecuperado,
                    ultimaVez: datos.ultimaRecuperacion
                });
            }
        });
        
        // Ordenar por la fecha de la √∫ltima recuperaci√≥n (m√°s reciente primero)
        mejoresComebacks.sort((a, b) => new Date(b.ultimaVez) - new Date(a.ultimaVez));
        
        // 6. Encontrar al Rey de la Monta√±a (primer puesto en la clasificaci√≥n)
        const reyMontana = [];
        if (participantesConTotales.length > 0) {
          // Ordenar por clasificaci√≥n (oro > plata > bronce)
          const clasificados = [...participantesConTotales].sort((a, b) => {
            if (a.oro !== b.oro) return b.oro - a.oro;
            if (a.plata !== b.plata) return b.plata - a.plata;
            return b.bronce - a.bronce;
          });
          
          // Tomar el/los primeros puestos
          const primerPuesto = clasificados[0];
          reyMontana.push(primerPuesto);
          
          // Verificar si hay empate en el primer puesto
          for (let i = 1; i < clasificados.length; i++) {
            if (clasificados[i].oro === primerPuesto.oro &&
                clasificados[i].plata === primerPuesto.plata &&
                clasificados[i].bronce === primerPuesto.bronce) {
              reyMontana.push(clasificados[i]);
            } else {
              break;
            }
          }
        }
        
        // 6. Encontrar al participante con m√°s posiciones subidas en total (De Cero a H√©roe)
        let mejorMejora = { nombre: null, mejoraTotal: 0, posicionActual: 0 };
        try {
          const mejorasTotales = JSON.parse(localStorage.getItem('mejorasTotales') || '{}');
          const historial = JSON.parse(localStorage.getItem('historialClasificacion') || '[]');
          const clasificacionActual = historial.length > 0 ? 
            historial[historial.length - 1].clasificacion : [];
          
          // Encontrar al participante con m√°s posiciones subidas en total
          Object.entries(mejorasTotales).forEach(([nombre, mejoraTotal]) => {
            if (mejoraTotal > mejorMejora.mejoraTotal) {
              const posicionActual = clasificacionActual.find(p => p.nombre === nombre)?.posicion || 0;
              mejorMejora = {
                nombre,
                mejoraTotal: parseInt(mejoraTotal),
                posicionActual: posicionActual
              };
            }
          });
        } catch (e) {
          console.error('Error al calcular mejoras de clasificaci√≥n:', e);
        }
        
        // Si hay participantes con medallas, mostrar el/los m√°ximos ganadores
        if (participantesConTotales.length > 0 && participantesConTotales[0].total > 0) {
          const maxTotal = participantesConTotales[0].total;
          const maximosGanadores = participantesConTotales.filter(p => p.total === maxTotal);
          
          // Crear elemento de logro para el/los m√°ximos ganadores
          const logro = document.createElement('div');
          logro.className = 'logro';
          
          if (maximosGanadores.length === 1) {
            const ganador = maximosGanadores[0];
            logro.innerHTML = `
              <div class="logro-icono">üëë</div>
              <div class="logro-contenido">
                <h3>Rey de las medallas</h3>
                <p>${ganador.nombre} lidera con ${ganador.total} medallas en total</p>
                <div class="medal-count">
                  <span class="gold">ü•á ${ganador.oro}</span>
                  <span class="silver">ü•à ${ganador.plata}</span>
                  <span class="bronze">ü•â ${ganador.bronce}</span>
                </div>
              </div>
            `;
          } else {
            const nombres = maximosGanadores.map(g => g.nombre);
            const textoNombres = formatearNombres(nombres);
            
            logro.innerHTML = `
              <div class="logro-icono">üëë</div>
              <div class="logro-contenido">
                <h3>Reyes de las medallas</h3>
                <p>${textoNombres} lideran con ${maxTotal} medallas cada uno</p>
                <div class="participantes-ganadores">
                  ${maximosGanadores.map(g => `
                    <div class="participante">
                      <strong>${g.nombre}:</strong>
                      <span class="gold">ü•á ${g.oro}</span>
                      <span class="silver">ü•à ${g.plata}</span>
                      <span class="bronze">ü•â ${g.bronce}</span>
                    </div>
                  `).join('')}
                </div>
              </div>
            `;
          }
          
          container.appendChild(logro);
        }
        
        // Mostrar logro "Comeback del a√±o" si hay datos
        if (mejoresComebacks.length > 0) {
            const logroComeback = document.createElement('div');
            logroComeback.className = 'logro';
            logroComeback.style.background = 'var(--logro-azul-fondo)';
            logroComeback.style.borderLeft = '4px solid var(--logro-azul-borde)';
            
            // Si hay un solo ganador
            if (mejoresComebacks.length === 1) {
                const mejor = mejoresComebacks[0];
                const fecha = new Date(mejor.ultimaVez).toLocaleDateString('es-ES', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
                
                logroComeback.innerHTML = `
                    <div class="logro-icono">üî•</div>
                    <div class="logro-contenido">
                        <h3>Comeback del A√±o</h3>
                        <p>${mejor.nombre} ha recuperado el primer puesto ${mejor.veces} ${mejor.veces === 1 ? 'vez' : 'veces'}</p>
                        <p class="fecha-pequena">√öltima recuperaci√≥n: ${fecha}</p>
                    </div>
                `;
            } 
            // Si hay empate
            else {
                const nombres = mejoresComebacks.map(c => c.nombre);
                const textoNombres = formatearNombres(nombres);
                const veces = mejoresComebacks[0].veces;
                const fecha = new Date(mejoresComebacks[0].ultimaVez).toLocaleDateString('es-ES', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
                
                logroComeback.innerHTML = `
                    <div class="logro-icono">üî•</div>
                    <div class="logro-contenido">
                        <h3>Comeback del A√±o</h3>
                        <p>${textoNombres} han recuperado el primer puesto ${veces} ${veces === 1 ? 'vez' : 'veces'}</p>
                        <p class="fecha-pequena">√öltima recuperaci√≥n: ${fecha}</p>
                        <div class="participantes-ganadores">
                            ${mejoresComebacks.map(c => `
                                <div class="participante">
                                    <strong>${c.nombre}:</strong>
                                    <span>${c.veces} ${c.veces === 1 ? 'vez' : 'veces'}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }
            
            container.appendChild(logroComeback);
        }
        
        // Mostrar logro "Pureza Dorada" si hay participantes que cumplan el criterio
        if (soloOro.length > 0) {
          const logroOro = document.createElement('div');
          logroOro.className = 'logro';
          logroOro.style.background = 'var(--logro-oro-fondo)';
          logroOro.style.borderLeft = '4px solid var(--logro-oro-borde)';
          
          const nombres = soloOro.map(p => p.nombre);
          const textoNombres = formatearNombres(nombres);
          const totalOros = soloOro.reduce((sum, p) => sum + p.oro, 0);
          
          logroOro.innerHTML = `
            <div class="logro-icono">üåü</div>
            <div class="logro-contenido">
              <h3>Pureza Dorada</h3>
              <p>${textoNombres} ${soloOro.length > 1 ? 'solo tienen' : 'solo tiene'} medallas de oro (${totalOros} en total)</p>
              <div class="participantes-ganadores">
                ${soloOro.map(p => `
                  <div class="participante">
                    <strong>${p.nombre}:</strong>
                    <span class="gold">ü•á ${p.oro} oro</span>
                  </div>
                `).join('')}
              </div>
            </div>
          `;
          container.appendChild(logroOro);
        }
        
        // Mostrar logro "Equilibrio Perfecto" si hay participantes que cumplan el criterio
        if (equilibrioPerfecto.length > 0) {
          const logroEquilibrio = document.createElement('div');
          logroEquilibrio.className = 'logro';
          logroEquilibrio.style.background = 'var(--logro-verde-fondo)';
          logroEquilibrio.style.borderLeft = '4px solid var(--logro-verde-borde)';
          
          const nombres = equilibrioPerfecto.map(p => p.nombre);
          const textoNombres = formatearNombres(nombres);
          const cantidad = equilibrioPerfecto[0].oro; // Todos tienen la misma cantidad
          
          logroEquilibrio.innerHTML = `
            <div class="logro-icono">‚öñÔ∏è</div>
            <div class="logro-contenido">
              <h3>Equilibrio Perfecto</h3>
              <p>${textoNombres} ${equilibrioPerfecto.length > 1 ? 'mantienen' : 'mantiene'} un equilibrio perfecto con ${cantidad} medallas de cada tipo</p>
              <div class="participantes-ganadores">
                ${equilibrioPerfecto.map(p => `
                  <div class="participante">
                    <strong>${p.nombre}:</strong>
                    <span class="gold">ü•á ${p.oro}</span>
                    <span class="silver">ü•à ${p.plata}</span>
                    <span class="bronze">ü•â ${p.bronce}</span>
                  </div>
                `).join('')}
              </div>
            </div>
          `;
          container.appendChild(logroEquilibrio);
        }
        
        // Mostrar logros "Estilo √önico" agrupados por tipo de medalla
        Object.entries(estiloUnico).forEach(([tipo, participantes]) => {
          if (participantes.length > 0) {
            const logroEstiloUnico = document.createElement('div');
            logroEstiloUnico.className = 'logro';
            logroEstiloUnico.style.background = 'var(--logro-morado-fondo)';
            logroEstiloUnico.style.borderLeft = '4px solid var(--logro-morado-borde)';
            
            const nombres = participantes.map(p => p.nombre);
            const textoNombres = formatearNombres(nombres);
            const total = participantes.reduce((sum, p) => sum + (p[tipo] || 0), 0);
            
            const icono = tipo === 'oro' ? 'ü•á' : (tipo === 'plata' ? 'ü•à' : 'ü•â');
            const textoMedalla = tipo === 'oro' ? 'oro' : (tipo === 'plata' ? 'plata' : 'bronce');
            const colorClase = tipo === 'oro' ? 'gold' : (tipo === 'plata' ? 'silver' : 'bronze');
            
            logroEstiloUnico.innerHTML = `
              <div class="logro-icono">üéØ</div>
              <div class="logro-contenido">
                <h3>Estilo √önico - ${textoMedalla.charAt(0).toUpperCase() + textoMedalla.slice(1)}</h3>
                <p>${textoNombres} ${participantes.length > 1 ? 'se especializan' : 'se especializa'} en medallas de ${textoMedalla} (${total} en total)</p>
                <div class="participantes-ganadores">
                  ${participantes.map(p => `
                    <div class="participante">
                      <strong>${p.nombre}:</strong>
                      <span class="${colorClase}">${icono} ${p[tipo]} ${textoMedalla}</span>
                    </div>
                  `).join('')}
                </div>
              </div>
            `;
            container.appendChild(logroEstiloUnico);
          }
        });
        
        // Mostrar logro "De Cero a H√©roe" (m√°s posiciones subidas en total)
        if (mejorMejora.nombre && mejorMejora.mejoraTotal > 0) {
          const logroMejora = document.createElement('div');
          logroMejora.className = 'logro';
          logroMejora.style.background = 'var(--logro-verde-fondo)';
          logroMejora.style.borderLeft = '4px solid var(--logro-verde-borde)';
          
          let textoPosicion = '';
          if (mejorMejora.posicionActual > 0) {
            textoPosicion = ` (actualmente en el ${mejorMejora.posicionActual}¬∫ puesto)`;
          }
          
          logroMejora.innerHTML = `
            <div class="logro-icono">üöÄ</div>
            <div class="logro-contenido">
              <h3>De Cero a H√©roe</h3>
              <p>${mejorMejora.nombre} ha subido m√°s posiciones en total${textoPosicion}</p>
              <div class="participante">
                <strong>Total subidas:</strong>
                <span class="green">+${mejorMejora.mejoraTotal} posiciones</span>
              </div>
            </div>
          `;
          
          // Insertar despu√©s del Rey de la Monta√±a o al principio
          if (container.firstChild) {
            container.insertBefore(logroMejora, container.firstChild.nextSibling);
          } else {
            container.appendChild(logroMejora);
          }
        }
        
        // Mostrar logro "Rey de la Monta√±a" (l√≠der actual)
        if (reyMontana.length > 0) {
          const logroReyMontana = document.createElement('div');
          logroReyMontana.className = 'logro';
          logroReyMontana.style.background = 'var(--logro-oro-fondo)';
          logroReyMontana.style.borderLeft = '4px solid var(--logro-oro-borde)';
          
          if (reyMontana.length === 1) {
            const lider = reyMontana[0];
            logroReyMontana.innerHTML = `
              <div class="logro-icono">üèîÔ∏è</div>
              <div class="logro-contenido">
                <h3>Rey de la Monta√±a</h3>
                <p>${lider.nombre} lidera la clasificaci√≥n con ${lider.total} medallas en total</p>
                <div class="medal-count">
                  <span class="gold">ü•á ${lider.oro}</span>
                  <span class="silver">ü•à ${lider.plata}</span>
                  <span class="bronze">ü•â ${lider.bronce}</span>
                </div>
              </div>
            `;
          } else {
            const nombres = reyMontana.map(p => p.nombre);
            const textoNombres = formatearNombres(nombres);
            
            logroReyMontana.innerHTML = `
              <div class="logro-icono">üèîÔ∏è</div>
              <div class="logro-contenido">
                <h3>Reyes de la Monta√±a</h3>
                <p>${textoNombres} lideran la clasificaci√≥n con ${reyMontana[0].total} medallas cada uno</p>
                <div class="participantes-ganadores">
                  ${reyMontana.map(p => `
                    <div class="participante">
                      <strong>${p.nombre}:</strong>
                      <span class="gold">ü•á ${p.oro}</span>
                      <span class="silver">ü•à ${p.plata}</span>
                      <span class="bronze">ü•â ${p.bronce}</span>
                    </div>
                  `).join('')}
                </div>
              </div>
            `;
          }
          
          // Insertar al principio de la lista de logros
          if (container.firstChild) {
            container.insertBefore(logroReyMontana, container.firstChild);
          } else {
            container.appendChild(logroReyMontana);
          }
        }
        
        // Mostrar mensaje si no hay logros para mostrar
        if (container.children.length === 0) {
          container.innerHTML = `
            <div class="no-logros">
              <p>¬°A√∫n no hay suficientes datos para mostrar logros!</p>
              <p>Empieza a asignar medallas a los participantes para ver sus logros destacados.</p>
            </div>
          `;
        }
        
        // Mostrar datos de depuraci√≥n en consola
        console.log('=== DATOS DE DEPURACI√ìN ===');
        console.log('Participantes:', participantes);
        console.log('Medallas registradas:', medallas);
      }
      
      // Cargar logros al iniciar la p√°gina
      cargarLogrosDestacados();
    });
  </script>
</body>
</html>
